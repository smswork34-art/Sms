<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMS Mailing - –ú–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0088cc 0%, #34b7f1 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding-bottom: 80px;
        }

        .app-header {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 136, 204, 0.2);
            text-align: center;
        }

        .logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #0088cc, #34b7f1);
            border-radius: 20px;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            color: white;
        }

        h1 {
            color: #0088cc;
            font-size: 28px;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 16px;
            line-height: 1.5;
            margin-bottom: 15px;
        }

        .prices {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }

        .price-badge {
            background: #f0f9ff;
            padding: 8px 15px;
            border-radius: 10px;
            color: #0088cc;
            font-weight: 600;
            font-size: 14px;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 5px 15px rgba(0, 136, 204, 0.1);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-2px);
        }

        .card-title {
            color: #0088cc;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-title i {
            font-size: 20px;
        }

        .btn {
            background: linear-gradient(135deg, #0088cc, #34b7f1);
            color: white;
            border: none;
            padding: 16px 25px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            margin: 10px 0;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: linear-gradient(135deg, #0077b3, #2aa8e0);
            box-shadow: 0 5px 15px rgba(0, 136, 204, 0.3);
        }

        .btn-secondary {
            background: white;
            color: #0088cc;
            border: 2px solid #0088cc;
        }

        .btn-secondary:hover {
            background: #f0f9ff;
        }

        .btn-success {
            background: linear-gradient(135deg, #00c851, #5eff8f);
        }

        .btn-success:hover {
            background: linear-gradient(135deg, #00b347, #4cff7a);
        }

        .btn-admin {
            background: linear-gradient(135deg, #8e44ad, #9b59b6);
        }

        .btn-admin:hover {
            background: linear-gradient(135deg, #7d3c98, #8e44ad);
        }

        .balance-card {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .balance-item {
            background: linear-gradient(135deg, #f0f9ff, #e1f5fe);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 2px solid #d1ecff;
        }

        .currency {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .amount {
            font-size: 32px;
            font-weight: 700;
            color: #0088cc;
        }

        .currency-symbol {
            font-size: 20px;
            margin-right: 2px;
        }

        .section {
            margin-bottom: 25px;
        }

        .section-title {
            color: white;
            font-size: 20px;
            margin-bottom: 15px;
            padding-left: 10px;
            font-weight: 600;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #0088cc;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 14px;
            color: #666;
        }

        .nav-bottom {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-around;
            border-top-left-radius: 20px;
            border-top-right-radius: 20px;
            box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.1);
        }

        .nav-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            color: #666;
            background: none;
            border: none;
            cursor: pointer;
            padding: 10px;
            border-radius: 10px;
            transition: all 0.3s ease;
            flex: 1;
            max-width: 100px;
        }

        .nav-btn:hover {
            background: #f0f9ff;
            color: #0088cc;
        }

        .nav-btn.active {
            color: #0088cc;
            background: #f0f9ff;
        }

        .nav-btn i {
            font-size: 22px;
        }

        .nav-btn span {
            font-size: 12px;
            font-weight: 500;
        }

        .page {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .page.active {
            display: block;
        }

        .history-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .history-item:last-child {
            border-bottom: none;
        }

        .history-type {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .history-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }

        .history-icon.deposit {
            background: linear-gradient(135deg, #00c851, #5eff8f);
        }

        .history-icon.payment {
            background: linear-gradient(135deg, #ff4444, #ff8888);
        }

        .history-details h4 {
            color: #333;
            font-size: 16px;
            margin-bottom: 5px;
        }

        .history-details p {
            color: #666;
            font-size: 14px;
        }

        .history-amount {
            text-align: right;
        }

        .history-amount .amount {
            font-size: 18px;
            font-weight: 600;
        }

        .history-amount .currency {
            font-size: 12px;
            color: #999;
        }

        .deposit-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .deposit-option {
            background: linear-gradient(135deg, #f8fdff, #e6f7ff);
            border: 2px solid #d1ecff;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .deposit-option:hover {
            background: linear-gradient(135deg, #e6f7ff, #d4f1ff);
            border-color: #0088cc;
            transform: translateY(-3px);
        }

        .deposit-option.active {
            background: linear-gradient(135deg, #0088cc, #34b7f1);
            border-color: #0088cc;
            color: white;
        }

        .deposit-option.active .currency {
            color: white;
        }

        .deposit-option i {
            font-size: 32px;
            margin-bottom: 10px;
            color: #0088cc;
        }

        .deposit-option.active i {
            color: white;
        }

        .deposit-option .currency {
            font-size: 18px;
            font-weight: 600;
            color: #0088cc;
            margin-bottom: 5px;
        }

        .deposit-option.active .currency {
            color: white;
        }

        .deposit-amounts {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .amount-btn {
            background: white;
            border: 2px solid #d1ecff;
            border-radius: 10px;
            padding: 15px 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            color: #0088cc;
        }

        .amount-btn:hover {
            background: #f0f9ff;
            border-color: #0088cc;
        }

        .amount-btn.active {
            background: #0088cc;
            color: white;
            border-color: #0088cc;
        }

        .custom-amount {
            margin-top: 20px;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #0088cc;
            font-weight: 500;
        }

        input, textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #d1ecff;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
        }

        input:focus, textarea:focus {
            outline: none;
            border-color: #0088cc;
            box-shadow: 0 0 0 3px rgba(0, 136, 204, 0.1);
        }

        .info-box {
            background: #f0f9ff;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid #0088cc;
        }

        .info-box p {
            color: #333;
            font-size: 14px;
            line-height: 1.5;
        }

        .address-box {
            background: #f8fdff;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            border: 2px dashed #0088cc;
            word-break: break-all;
            font-family: monospace;
            font-size: 14px;
            color: #333;
            text-align: center;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #0088cc;
        }

        .loading i {
            font-size: 40px;
            margin-bottom: 15px;
        }

        .hash-input-section {
            margin-top: 20px;
            display: none;
        }

        .hash-input-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .admin-access-section {
            margin-top: 20px;
            display: none;
        }

        .admin-access-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .admin-panel {
            display: none;
        }

        .admin-panel.active {
            display: block;
        }

        .admin-header {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(142, 68, 173, 0.2);
            text-align: center;
        }

        .admin-logo {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #8e44ad, #9b59b6);
            border-radius: 15px;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            color: white;
        }

        .admin-stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .admin-stat-item {
            background: white;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(142, 68, 173, 0.1);
        }

        .admin-stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #8e44ad;
            margin-bottom: 5px;
        }

        .admin-stat-label {
            font-size: 14px;
            color: #666;
        }

        .admin-menu {
            display: grid;
            gap: 10px;
        }

        .admin-btn {
            background: white;
            border: 2px solid #e6d0f1;
            border-radius: 12px;
            padding: 18px 20px;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }

        .admin-btn:hover {
            background: #f9f0ff;
            border-color: #8e44ad;
            transform: translateY(-2px);
        }

        .admin-btn i {
            font-size: 20px;
            color: #8e44ad;
        }

        .user-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .user-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .user-info h4 {
            color: #333;
            font-size: 16px;
            margin-bottom: 5px;
        }

        .user-info p {
            color: #666;
            font-size: 14px;
        }

        .user-balance {
            text-align: right;
        }

        .user-balance .amount {
            font-size: 18px;
            font-weight: 600;
            color: #8e44ad;
        }

        .user-balance .currency {
            font-size: 12px;
            color: #999;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        #home {
            padding-top: 10px;
            padding-bottom: 20px;
        }

        .app-header {
            margin-top: 10px;
        }

        .btn-admin {
            margin-bottom: 80px;
        }

        @media (max-width: 600px) {
            .container {
                padding: 10px;
            }
            
            .app-header {
                padding: 20px;
            }
            
            .balance-card {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .deposit-amounts {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .admin-stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
        <div class="page active" id="home">
            <div class="app-header">
                <div class="logo">
                    <i class="fas fa-sms"></i>
                </div>
                <h1>SMS Mailing</h1>
                <p class="subtitle">–û—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ –°–ú–° —Ä–∞—Å—Å—ã–ª–∫–∏ –±—ã—Å—Ç—Ä–æ –∏ —É–¥–æ–±–Ω–æ. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.</p>
                <div class="prices">
                    <div class="price-badge">
                        <i class="fas fa-gem"></i> 1 –°–ú–° = 1 USDT
                    </div>
                    <div class="price-badge">
                        <i class="fas fa-bolt"></i> 1 –°–ú–° = 1.63 TON
                    </div>
                </div>
            </div>

            <div class="balance-card">
                <div class="balance-item">
                    <div class="currency">
                        <i class="fas fa-gem"></i> USDT
                    </div>
                    <div class="amount">
                        <span class="currency-symbol">$</span>
                        <span id="balance-usdt">0</span>
                    </div>
                </div>
                <div class="balance-item">
                    <div class="currency">
                        <i class="fas fa-bolt"></i> TON
                    </div>
                    <div class="amount">
                        <span class="currency-symbol">‚è£</span>
                        <span id="balance-ton">0</span>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2 class="section-title">–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
                <button class="btn" onclick="showPage('mailing')">
                    <i class="fas fa-paper-plane"></i>
                    –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É
                </button>
                <button class="btn btn-secondary" onclick="showPage('deposit')">
                    <i class="fas fa-wallet"></i>
                    –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å
                </button>
            </div>

            <div class="section">
                <h2 class="section-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" id="total-sms">0</div>
                        <div class="stat-label">–í—Å–µ–≥–æ –°–ú–°</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="total-cost">0</div>
                        <div class="stat-label">–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="success-rate">100%</div>
                        <div class="stat-label">–£—Å–ø–µ—à–Ω—ã—Ö</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="pending">0</div>
                        <div class="stat-label">–í –æ–∂–∏–¥–∞–Ω–∏–∏</div>
                    </div>
                </div>
            </div>

            <div class="admin-access-section" id="admin-access-section">
                <div class="input-group">
                    <label for="admin-key">
                        <i class="fas fa-key"></i> –ö–ª—é—á –¥–æ—Å—Ç—É–ø–∞
                    </label>
                    <input 
                        type="password" 
                        id="admin-key" 
                        placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞"
                    >
                    <div style="font-size: 12px; color: #666; margin-top: 5px;">
                        –í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
                    </div>
                </div>
                
                <button class="btn btn-admin" onclick="enterAdminPanel()">
                    <i class="fas fa-sign-in-alt"></i>
                    –í–æ–π—Ç–∏ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å
                </button>
            </div>

            <button class="btn btn-admin" onclick="showAdminAccess()">
                <i class="fas fa-user-shield"></i>
                –í—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å
            </button>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–∞—Å—Å—ã–ª–∫–∏ -->
        <div class="page" id="mailing">
            <div class="card">
                <div class="card-title">
                    <i class="fas fa-paper-plane"></i>
                    –ù–æ–≤–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞
                </div>
                
                <div class="input-group">
                    <label for="phone-numbers">
                        <i class="fas fa-phone"></i> –ù–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤
                    </label>
                    <textarea 
                        id="phone-numbers" 
                        rows="5" 
                        placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä–∞ —á–µ—Ä–µ–∑ —Ç–æ—á–∫—É —Å –∑–∞–ø—è—Ç–æ–π:
+79991234567;
89991234567;
79001234567;"
                    ></textarea>
                </div>

                <div class="input-group">
                    <label for="sms-text">
                        <i class="fas fa-comment-alt"></i> –¢–µ–∫—Å—Ç –°–ú–°
                    </label>
                    <textarea 
                        id="sms-text" 
                        rows="4" 
                        placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è..."
                        maxlength="1600"
                    ></textarea>
                    <div style="text-align: right; margin-top: 5px; font-size: 14px; color: #666;">
                        <span id="char-count">0</span>/1600 —Å–∏–º–≤–æ–ª–æ–≤
                    </div>
                </div>

                <div class="info-box">
                    <p><strong>–§–æ—Ä–º–∞—Ç –Ω–æ–º–µ—Ä–æ–≤:</strong><br>
                    ‚Ä¢ –ù–∞—á–∏–Ω–∞—é—Ç—Å—è –Ω–∞ +7, 7 –∏–ª–∏ 8<br>
                    ‚Ä¢ –†–∞–∑–¥–µ–ª—è—é—Ç—Å—è —Ç–æ—á–∫–æ–π —Å –∑–∞–ø—è—Ç–æ–π (;)<br>
                    ‚Ä¢ –ö–∞–∂–¥—ã–π –Ω–æ–º–µ—Ä —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏</p>
                </div>

                <div class="info-box">
                    <p><strong>–°—Ç–æ–∏–º–æ—Å—Ç—å:</strong><br>
                    ‚Ä¢ 1 –Ω–æ–º–µ—Ä = 1 USDT –∏–ª–∏ 1.63 TON<br>
                    ‚Ä¢ –ö –æ–ø–ª–∞—Ç–µ: <span id="sms-cost">0</span> USDT / <span id="sms-cost-ton">0</span> TON</p>
                </div>

                <button class="btn" onclick="submitMailing()">
                    <i class="fas fa-paper-plane"></i>
                    –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é
                </button>
                <button class="btn btn-secondary" onclick="showPage('home')">
                    <i class="fas fa-arrow-left"></i>
                    –ù–∞–∑–∞–¥
                </button>
            </div>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è -->
        <div class="page" id="deposit">
            <div class="card">
                <div class="card-title">
                    <i class="fas fa-wallet"></i>
                    –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
                </div>

                <div class="deposit-options">
                    <div class="deposit-option active" onclick="selectCurrency('USDT')">
                        <i class="fas fa-gem"></i>
                        <div class="currency">USDT</div>
                        <div style="font-size: 12px; color: #666;">TRON (TRC20)</div>
                    </div>
                    <div class="deposit-option" onclick="selectCurrency('TON')">
                        <i class="fas fa-bolt"></i>
                        <div class="currency">TON</div>
                        <div style="font-size: 12px; color: #666;">The Open Network</div>
                    </div>
                </div>

                <div class="deposit-amounts">
                    <div class="amount-btn active" onclick="selectAmount(10)">10</div>
                    <div class="amount-btn" onclick="selectAmount(25)">25</div>
                    <div class="amount-btn" onclick="selectAmount(50)">50</div>
                    <div class="amount-btn" onclick="selectAmount(100)">100</div>
                    <div class="amount-btn" onclick="selectAmount(250)">250</div>
                    <div class="amount-btn" onclick="selectCustomAmount()">–î—Ä—É–≥–∞—è</div>
                </div>

                <div class="custom-amount" id="custom-amount-section" style="display: none;">
                    <div class="input-group">
                        <label>–°—É–º–º–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è (<span id="selected-currency">USDT</span>)</label>
                        <input 
                            type="number" 
                            id="custom-amount-input" 
                            placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É"
                            min="10"
                            step="0.1"
                        >
                        <div style="font-size: 12px; color: #666; margin-top: 5px;">
                            –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞: 10 <span id="min-currency">USDT</span>
                        </div>
                    </div>
                </div>

                <div class="info-box" id="deposit-info">
                    <p><strong>USDT (TRON TRC20)</strong><br>
                    –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–æ—á–Ω—É—é —Å—É–º–º—É –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –∞–¥—Ä–µ—Å.<br>
                    –ö–æ–º–∏—Å—Å–∏—é –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å.</p>
                </div>

                <div class="address-box" id="deposit-address">
                    TJSgjT9n1234567890abcdefghijklmnop
                </div>

                <div class="hash-input-section" id="hash-input-section">
                    <div class="input-group">
                        <label for="tx-hash">
                            <i class="fas fa-hashtag"></i> HASH —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
                        </label>
                        <input 
                            type="text" 
                            id="tx-hash" 
                            placeholder="–í–≤–µ–¥–∏—Ç–µ —Ö–µ—à —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: 0x1234...)"
                        >
                        <div style="font-size: 12px; color: #666; margin-top: 5px;">
                            –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ö–µ—à —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏–∑ –≤–∞—à–µ–≥–æ –∫–æ—à–µ–ª—å–∫–∞
                        </div>
                    </div>
                    
                    <button class="btn btn-success" onclick="submitPayment()">
                        <i class="fas fa-check"></i>
                        –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É
                    </button>
                </div>

                <button class="btn" onclick="copyAddress()">
                    <i class="fas fa-copy"></i>
                    –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∞–¥—Ä–µ—Å
                </button>
                <button class="btn btn-success" onclick="showHashInput()">
                    <i class="fas fa-money-check-alt"></i>
                    –Ø –æ–ø–ª–∞—Ç–∏–ª
                </button>
                <button class="btn btn-secondary" onclick="showPage('home')">
                    <i class="fas fa-arrow-left"></i>
                    –ù–∞–∑–∞–¥
                </button>
            </div>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∏—Å—Ç–æ—Ä–∏–∏ -->
        <div class="page" id="history">
            <div class="card">
                <div class="card-title">
                    <i class="fas fa-history"></i>
                    –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
                </div>
                
                <div id="transactions-list">
                    <div class="loading">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>–ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏...</p>
                    </div>
                </div>
                
                <button class="btn btn-secondary" onclick="showPage('home')">
                    <i class="fas fa-arrow-left"></i>
                    –ù–∞–∑–∞–¥
                </button>
            </div>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏ -->
        <div class="page" id="admin-panel">
            <div class="admin-header">
                <div class="admin-logo">
                    <i class="fas fa-user-shield"></i>
                </div>
                <h1>–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</h1>
                <p class="subtitle">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π SMS —Ä–∞—Å—Å—ã–ª–æ–∫</p>
            </div>

            <div class="admin-stats-grid">
                <div class="admin-stat-item">
                    <div class="admin-stat-value" id="admin-total-users">0</div>
                    <div class="admin-stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                </div>
                <div class="admin-stat-item">
                    <div class="admin-stat-value" id="admin-total-mailings">0</div>
                    <div class="admin-stat-label">–†–∞—Å—Å—ã–ª–æ–∫</div>
                </div>
                <div class="admin-stat-item">
                    <div class="admin-stat-value" id="admin-pending">0</div>
                    <div class="admin-stat-label">–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ</div>
                </div>
                <div class="admin-stat-item">
                    <div class="admin-stat-value" id="admin-total-balance">0</div>
                    <div class="admin-stat-label">USDT</div>
                </div>
            </div>

            <div class="admin-menu">
                <button class="admin-btn" onclick="showAdminSection('payments')">
                    <i class="fas fa-money-check-alt"></i>
                    –°–ø–∏—Å–æ–∫ –ø–ª–∞—Ç–µ–∂–µ–π
                </button>
                <button class="admin-btn" onclick="showAdminSection('mailings')">
                    <i class="fas fa-envelope"></i>
                    –ó–∞—è–≤–∫–∏ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É
                </button>
                <button class="admin-btn" onclick="showAdminSection('users')">
                    <i class="fas fa-users"></i>
                    –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
                </button>
                <button class="admin-btn" onclick="showAdminSection('settings')">
                    <i class="fas fa-cog"></i>
                    –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã
                </button>
            </div>

            <div id="admin-content" style="margin-top: 20px;">
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-money-check-alt"></i>
                        –°–ø–∏—Å–æ–∫ –ø–ª–∞—Ç–µ–∂–µ–π
                    </div>
                    <div class="user-list" id="payment-requests-list">
                        <div class="loading">
                            <i class="fas fa-spinner fa-spin"></i>
                            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π...</p>
                        </div>
                    </div>
                </div>
            </div>

            <button class="btn btn-secondary" onclick="showPage('home')" style="margin-top: 20px;">
                <i class="fas fa-arrow-left"></i>
                –ù–∞ –≥–ª–∞–≤–Ω—É—é
            </button>
        </div>

        <!-- –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
        <div class="nav-bottom">
            <button class="nav-btn active" onclick="showPage('home')">
                <i class="fas fa-home"></i>
                <span>–ì–ª–∞–≤–Ω–∞—è</span>
            </button>
            <button class="nav-btn" onclick="showPage('mailing')">
                <i class="fas fa-paper-plane"></i>
                <span>–†–∞—Å—Å—ã–ª–∫–∞</span>
            </button>
            <button class="nav-btn" onclick="showPage('deposit')">
                <i class="fas fa-wallet"></i>
                <span>–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</span>
            </button>
            <button class="nav-btn" onclick="showPage('history')">
                <i class="fas fa-history"></i>
                <span>–ò—Å—Ç–æ—Ä–∏—è</span>
            </button>
        </div>
    </div>

    <script>
        // ==================== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ====================
        // ‚ö†Ô∏è –í–°–¢–ê–í–¨ –°–Æ–î–ê –°–í–û–ô URL –∏–∑ Google Apps Script ‚ö†Ô∏è
        const API_URL = '–¢–í–û–ô_–°–ö–û–ü–ò–†–û–í–ê–ù–ù–´–ô_URL_–ó–î–ï–°–¨';
        const ADMIN_KEY = '1235';
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.MainButton.hide();
        
        // –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
        const tgUser = tg.initDataUnsafe?.user || {
            id: 6864759899,
            username: 'admin',
            first_name: '–ê–¥–º–∏–Ω'
        };
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        let appState = {
            selectedCurrency: 'USDT',
            selectedAmount: 10,
            isAdmin: false
        };

        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const elements = {
            balanceUsdt: document.getElementById('balance-usdt'),
            balanceTon: document.getElementById('balance-ton'),
            smsCost: document.getElementById('sms-cost'),
            smsCostTon: document.getElementById('sms-cost-ton'),
            phoneNumbers: document.getElementById('phone-numbers'),
            smsText: document.getElementById('sms-text'),
            charCount: document.getElementById('char-count'),
            depositInfo: document.getElementById('deposit-info'),
            depositAddress: document.getElementById('deposit-address'),
            selectedCurrency: document.getElementById('selected-currency'),
            minCurrency: document.getElementById('min-currency'),
            customAmountSection: document.getElementById('custom-amount-section'),
            customAmountInput: document.getElementById('custom-amount-input'),
            transactionsList: document.getElementById('transactions-list'),
            hashInputSection: document.getElementById('hash-input-section'),
            txHash: document.getElementById('tx-hash'),
            adminAccessSection: document.getElementById('admin-access-section'),
            adminKey: document.getElementById('admin-key')
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            updateSMSCost();
            selectCurrency('USDT');
            selectAmount(10);
        });

        function setupEventListeners() {
            elements.smsText.addEventListener('input', function() {
                elements.charCount.textContent = this.value.length;
                updateSMSCost();
            });

            elements.phoneNumbers.addEventListener('input', updateSMSCost);

            elements.customAmountInput.addEventListener('input', function() {
                const amount = parseFloat(this.value) || 0;
                if (amount >= 10) {
                    appState.selectedAmount = amount;
                }
            });
        }

        // ==================== –ù–ê–í–ò–ì–ê–¶–ò–Ø ====================
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });

            document.getElementById(pageId).classList.add('active');

            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            const navBtn = document.querySelector(`.nav-btn[onclick*="${pageId}"]`);
            if (navBtn) {
                navBtn.classList.add('active');
            } else {
                document.querySelector('.nav-btn[onclick*="home"]').classList.add('active');
            }

            switch(pageId) {
                case 'history':
                    loadTransactions();
                    break;
                case 'mailing':
                    updateSMSCost();
                    break;
                case 'deposit':
                    elements.hashInputSection.classList.remove('active');
                    elements.txHash.value = '';
                    break;
                case 'admin-panel':
                    if (appState.isAdmin) {
                        loadAdminPanel();
                    } else {
                        showPage('home');
                    }
                    break;
            }
        }

        // ==================== –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        async function sendToServer(action, data) {
            try {
                const params = new URLSearchParams();
                params.append('action', action);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
                for (const key in data) {
                    if (data[key] !== undefined && data[key] !== null) {
                        params.append(key, data[key]);
                    }
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                params.append('user_id', tgUser.id);
                params.append('username', tgUser.username || `user_${tgUser.id}`);
                params.append('first_name', tgUser.first_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å');
                
                const url = `${API_URL}?${params.toString()}`;
                
                console.log('–û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞:', url);
                
                const response = await fetch(url, {
                    method: 'GET',
                    mode: 'no-cors'
                });
                
                console.log('–î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ');
                return { success: true };
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:', error);
                return { success: false, error: error.message };
            }
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å —Å–µ—Ä–≤–µ—Ä–∞
        async function getFromServer(params) {
            try {
                const urlParams = new URLSearchParams(params);
                const url = `${API_URL}?${urlParams.toString()}`;
                
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return await response.json();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:', error);
                return null;
            }
        }
        
        // ==================== –†–ê–°–°–´–õ–ö–ê ====================
        function updateSMSCost() {
            const numbersText = elements.phoneNumbers.value;
            const numbers = numbersText.split(';')
                .map(n => n.trim())
                .filter(n => n.length > 5);
            
            const count = numbers.length;
            const costUSDT = count * 1;
            const costTON = count * 1.63;
            
            elements.smsCost.textContent = costUSDT.toFixed(2);
            elements.smsCostTon.textContent = costTON.toFixed(2);
        }
        
        async function submitMailing() {
            const numbers = elements.phoneNumbers.value.trim();
            const text = elements.smsText.value.trim();
            
            if (!numbers) {
                tg.showAlert('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤!');
                return;
            }
            
            if (!text) {
                tg.showAlert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –°–ú–°!');
                return;
            }
            
            const phoneArray = numbers.split(';')
                .map(n => n.trim())
                .filter(n => n.length > 5);
            const phoneCount = phoneArray.length;
            
            const costUSDT = phoneCount * 1;
            const costTON = phoneCount * 1.63;
            
            const confirm = await tg.showConfirm(
                `–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É?\n\n` +
                `üì± –ù–æ–º–µ—Ä–æ–≤: ${phoneCount}\n` +
                `üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å: ${costUSDT} USDT (${costTON} TON)\n` +
                `üìù –°—Ç–∞—Ç—É—Å: –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã`
            );
            
            if (!confirm) return;
            
            const result = await sendToServer('add_mailing', {
                phones: numbers,
                text: text,
                phone_count: phoneCount,
                cost_usdt: costUSDT.toFixed(2),
                cost_ton: costTON.toFixed(2)
            });
            
            if (result.success) {
                tg.showAlert(`‚úÖ –ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!\n\n–ù–æ–º–µ—Ä–æ–≤: ${phoneCount}\n–°—Ç–æ–∏–º–æ—Å—Ç—å: ${costUSDT} USDT\n\n–û–∂–∏–¥–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–ø–ª–∞—Ç—ã.`);
                
                elements.phoneNumbers.value = '';
                elements.smsText.value = '';
                elements.charCount.textContent = '0';
                
                showPage('home');
            } else {
                tg.showAlert('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞—è–≤–∫–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
            }
        }
        
        // ==================== –ü–õ–ê–¢–ï–ñ–ò ====================
        function selectCurrency(currency) {
            appState.selectedCurrency = currency;
            
            document.querySelectorAll('.deposit-option').forEach(option => {
                option.classList.remove('active');
            });
            
            if (currency === 'USDT') {
                document.querySelectorAll('.deposit-option')[0].classList.add('active');
                elements.depositInfo.innerHTML = `
                    <p><strong>USDT (TRON TRC20)</strong><br>
                    –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–æ—á–Ω—É—é —Å—É–º–º—É –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –∞–¥—Ä–µ—Å.<br>
                    –ö–æ–º–∏—Å—Å–∏—é –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å.</p>
                `;
                elements.selectedCurrency.textContent = 'USDT';
                elements.minCurrency.textContent = 'USDT';
                elements.depositAddress.textContent = 'TJSgjT9n1234567890abcdefghijklmnop';
            } else {
                document.querySelectorAll('.deposit-option')[1].classList.add('active');
                elements.depositInfo.innerHTML = `
                    <p><strong>TON (The Open Network)</strong><br>
                    –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–æ—á–Ω—É—é —Å—É–º–º—É –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –∞–¥—Ä–µ—Å.<br>
                    –ö–æ–º–∏—Å—Å–∏—é –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å.</p>
                `;
                elements.selectedCurrency.textContent = 'TON';
                elements.minCurrency.textContent = 'TON';
                elements.depositAddress.textContent = 'EQCD39VS5jcptHL8vMjEXrzGaRcCVYto7HUn4bpAOg8xqB2N';
            }
        }
        
        function selectAmount(amount) {
            appState.selectedAmount = amount;
            
            document.querySelectorAll('.amount-btn').forEach(btn => {
                btn.classList.remove('active');
                if (parseFloat(btn.textContent) === amount || 
                    (btn.textContent === '–î—Ä—É–≥–∞—è' && amount === 'custom')) {
                    btn.classList.add('active');
                }
            });
            
            if (amount !== 'custom') {
                elements.customAmountSection.style.display = 'none';
                elements.customAmountInput.value = amount;
            } else {
                elements.customAmountSection.style.display = 'block';
                elements.customAmountInput.focus();
            }
        }
        
        function selectCustomAmount() {
            selectAmount('custom');
        }
        
        function copyAddress() {
            const address = elements.depositAddress.textContent;
            navigator.clipboard.writeText(address)
                .then(() => {
                    tg.showAlert('–ê–¥—Ä–µ—Å —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
                })
                .catch(err => {
                    tg.showAlert('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è: ' + err);
                });
        }
        
        function showHashInput() {
            elements.hashInputSection.classList.add('active');
            elements.txHash.focus();
            
            tg.showAlert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ HASH —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã');
        }
        
        async function submitPayment() {
            const hash = elements.txHash.value.trim();
            const amount = appState.selectedAmount;
            const currency = appState.selectedCurrency;
            
            if (!hash) {
                tg.showAlert('–í–≤–µ–¥–∏—Ç–µ HASH —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏!');
                return;
            }
            
            if (hash.length < 10) {
                tg.showAlert('HASH —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–µ –º–µ–Ω–µ–µ 10 —Å–∏–º–≤–æ–ª–æ–≤!');
                return;
            }
            
            const confirm = await tg.showConfirm(
                `–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–ª–∞—Ç–µ–∂?\n\n` +
                `üí∞ –°—É–º–º–∞: ${amount} ${currency}\n` +
                `üîó –•–µ—à: ${hash.substring(0, 20)}...`
            );
            
            if (!confirm) return;
            
            const result = await sendToServer('add_payment', {
                amount: amount,
                currency: currency,
                hash: hash
            });
            
            if (result.success) {
                tg.showAlert(`‚úÖ –ü–ª–∞—Ç–µ–∂ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É!\n\n–ê–¥–º–∏–Ω –ø—Ä–æ–≤–µ—Ä–∏—Ç –µ–≥–æ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.`);
                
                elements.txHash.value = '';
                elements.hashInputSection.classList.remove('active');
                
                showPage('home');
            } else {
                tg.showAlert('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–ª–∞—Ç–µ–∂–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
            }
        }
        
        // ==================== –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ ====================
        function showAdminAccess() {
            elements.adminAccessSection.classList.add('active');
            elements.adminKey.focus();
        }
        
        function enterAdminPanel() {
            const key = elements.adminKey.value.trim();
            
            if (key !== ADMIN_KEY) {
                tg.showAlert('–ù–µ–≤–µ—Ä–Ω—ã–π –∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞!');
                return;
            }
            
            appState.isAdmin = true;
            tg.showAlert('–î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω! –í—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å...');
            
            elements.adminKey.value = '';
            elements.adminAccessSection.classList.remove('active');
            
            showPage('admin-panel');
        }
        
        async function loadAdminPanel() {
            try {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–ª–∞—Ç–µ–∂–∏
                const payments = await getFromServer({ sheet: 'payments' });
                if (payments && !payments.error) {
                    displayPaymentsInAdmin(payments);
                } else {
                    document.getElementById('payment-requests-list').innerHTML = 
                        '<p style="text-align: center; color: #666; padding: 20px;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π</p>';
                }
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∑–∞—è–≤–∫–∏
                const mailings = await getFromServer({ sheet: 'mailings' });
                if (mailings && !mailings.error) {
                    updateAdminStats(payments || [], mailings || []);
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏:', error);
                tg.showAlert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö');
            }
        }
        
        function displayPaymentsInAdmin(payments) {
            const container = document.getElementById('payment-requests-list');
            if (!container) return;
            
            let html = '';
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ payments - –º–∞—Å—Å–∏–≤
            if (!Array.isArray(payments)) {
                html = '<p style="text-align: center; color: #666; padding: 20px;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –ø–ª–∞—Ç–µ–∂–∞—Ö</p>';
                container.innerHTML = html;
                return;
            }
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –æ–∂–∏–¥–∞—é—â–∏–µ –ø–ª–∞—Ç–µ–∂–∏
            const pendingPayments = payments.filter(p => p.–°—Ç–∞—Ç—É—Å === '–æ–∂–∏–¥–∞–Ω–∏–µ');
            
            if (pendingPayments.length === 0) {
                html = '<p style="text-align: center; color: #666; padding: 20px;">–ù–µ—Ç –ø–ª–∞—Ç–µ–∂–µ–π –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ</p>';
            } else {
                pendingPayments.forEach(payment => {
                    html += `
                        <div class="payment-request" style="margin-bottom: 15px; padding: 15px; border: 2px solid #d1ecff; border-radius: 10px; background: #f8fdff;">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                                <div>
                                    <h4 style="margin: 0 0 5px 0; color: #333;">${payment.–ò–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'}</h4>
                                    <p style="margin: 0; color: #666; font-size: 14px;">
                                        ID: ${payment.ID_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è || 'N/A'}<br>
                                        –î–∞—Ç–∞: ${payment.–î–∞—Ç–∞ || 'N/A'}
                                    </p>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-size: 20px; font-weight: 700; color: #0088cc;">
                                        ${payment.–°—É–º–º–∞ || 0} ${payment.–í–∞–ª—é—Ç–∞ || 'USDT'}
                                    </div>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 10px;">
                                <div style="font-size: 12px; color: #666; margin-bottom: 5px;">–•–µ—à —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:</div>
                                <div style="background: white; padding: 10px; border-radius: 5px; font-family: monospace; font-size: 12px; word-break: break-all; color: #333;">
                                    ${payment.–•–µ—à_—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ || '–ù–µ —É–∫–∞–∑–∞–Ω'}
                                </div>
                            </div>
                            
                            <div style="display: flex; gap: 10px;">
                                <button onclick="tg.showAlert('–§—É–Ω–∫—Ü–∏—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞')" style="flex: 1; padding: 10px; background: linear-gradient(135deg, #00c851, #5eff8f); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 8px;">
                                    <i class="fas fa-check"></i>
                                    –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å
                                </button>
                                <button onclick="tg.showAlert('–§—É–Ω–∫—Ü–∏—è –æ—Ç–º–µ–Ω—ã –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞')" style="flex: 1; padding: 10px; background: linear-gradient(135deg, #ff4444, #ff8888); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 8px;">
                                    <i class="fas fa-times"></i>
                                    –û—Ç–º–µ–Ω–∏—Ç—å
                                </button>
                            </div>
                        </div>
                    `;
                });
            }
            
            container.innerHTML = html;
        }
        
        function updateAdminStats(payments, mailings) {
            if (!Array.isArray(payments)) payments = [];
            if (!Array.isArray(mailings)) mailings = [];
            
            const totalUsers = new Set(payments.map(p => p.ID_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è).filter(Boolean)).size;
            const totalMailings = mailings.length;
            const pendingPayments = payments.filter(p => p.–°—Ç–∞—Ç—É—Å === '–æ–∂–∏–¥–∞–Ω–∏–µ').length;
            const pendingMailings = mailings.filter(m => m.–°—Ç–∞—Ç—É—Å === '–æ–∂–∏–¥–∞–Ω–∏–µ').length;
            
            document.getElementById('admin-total-users').textContent = totalUsers;
            document.getElementById('admin-total-mailings').textContent = totalMailings;
            document.getElementById('admin-pending').textContent = pendingPayments + pendingMailings;
            
            const totalBalance = payments
                .filter(p => p.–°—Ç–∞—Ç—É—Å === '–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ')
                .reduce((sum, p) => sum + (parseFloat(p.–°—É–º–º–∞) || 0), 0);
            document.getElementById('admin-total-balance').textContent = totalBalance.toFixed(2);
        }
        
        function showAdminSection(section) {
            let content = '';
            
            switch(section) {
                case 'payments':
                    content = `
                        <div class="card">
                            <div class="card-title">
                                <i class="fas fa-money-check-alt"></i>
                                –°–ø–∏—Å–æ–∫ –ø–ª–∞—Ç–µ–∂–µ–π
                            </div>
                            <div class="user-list" id="payment-requests-list">
                                <div class="loading">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π...</p>
                                </div>
                            </div>
                        </div>
                    `;
                    setTimeout(() => {
                        loadAdminPanel();
                    }, 0);
                    break;
                    
                case 'mailings':
                    content = `
                        <div class="card">
                            <div class="card-title">
                                <i class="fas fa-envelope"></i>
                                –ó–∞—è–≤–∫–∏ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É
                            </div>
                            <div class="user-list" id="mailings-list">
                                <div class="loading">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞—è–≤–æ–∫...</p>
                                </div>
                            </div>
                        </div>
                    `;
                    setTimeout(async () => {
                        try {
                            const mailings = await getFromServer({ sheet: 'mailings' });
                            displayMailingsSection(mailings || []);
                        } catch (error) {
                            console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞—è–≤–æ–∫:', error);
                        }
                    }, 0);
                    break;
                    
                case 'users':
                    content = `
                        <div class="card">
                            <div class="card-title">
                                <i class="fas fa-users"></i>
                                –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
                            </div>
                            <div class="user-list">
                                <p style="text-align: center; color: #666; padding: 20px;">–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</p>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'settings':
                    content = `
                        <div class="card">
                            <div class="card-title">
                                <i class="fas fa-cog"></i>
                                –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã
                            </div>
                            <div class="input-group">
                                <label>–¶–µ–Ω–∞ –∑–∞ 1 SMS (USDT)</label>
                                <input type="number" value="1" min="0.1" step="0.1">
                            </div>
                            <div class="input-group">
                                <label>–¶–µ–Ω–∞ –∑–∞ 1 SMS (TON)</label>
                                <input type="number" value="1.63" min="0.1" step="0.01">
                            </div>
                            <div class="input-group">
                                <label>–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</label>
                                <input type="number" value="10" min="1" step="1">
                            </div>
                            <button class="btn" onclick="tg.showAlert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã (—Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º)')">
                                <i class="fas fa-save"></i>
                                –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                            </button>
                        </div>
                    `;
                    break;
            }
            
            document.getElementById('admin-content').innerHTML = content;
        }
        
        function displayMailingsSection(mailings) {
            const container = document.getElementById('mailings-list');
            if (!container) return;
            
            let html = '';
            
            if (!Array.isArray(mailings) || mailings.length === 0) {
                html = '<p style="text-align: center; color: #666; padding: 20px;">–ù–µ—Ç –∑–∞—è–≤–æ–∫ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É</p>';
            } else {
                mailings.forEach(mailing => {
                    const shortText = mailing.–¢–µ–∫—Å—Ç_–°–ú–° && mailing.–¢–µ–∫—Å—Ç_–°–ú–°.length > 50 
                        ? mailing.–¢–µ–∫—Å—Ç_–°–ú–°.substring(0, 50) + '...' 
                        : mailing.–¢–µ–∫—Å—Ç_–°–ú–° || '–ù–µ—Ç —Ç–µ–∫—Å—Ç–∞';
                    
                    html += `
                        <div class="mailing-request" style="margin-bottom: 15px; padding: 15px; border: 2px solid #e6d0f1; border-radius: 10px; background: #f9f0ff;">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                                <div>
                                    <h4 style="margin: 0 0 5px 0; color: #333;">${mailing.–ò–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'}</h4>
                                    <p style="margin: 0; color: #666; font-size: 14px;">
                                        ID: ${mailing.ID_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è || 'N/A'}<br>
                                        –î–∞—Ç–∞: ${mailing.–î–∞—Ç–∞ || 'N/A'}
                                    </p>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-size: 18px; font-weight: 700; color: #8e44ad;">
                                        ${mailing.–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ_–°–ú–° || 0} SMS
                                    </div>
                                    <div style="font-size: 14px; color: #666;">
                                        ${mailing.–°—Ç–æ–∏–º–æ—Å—Ç—å_USDT || 0} USDT
                                    </div>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 10px;">
                                <div style="font-size: 12px; color: #666; margin-bottom: 5px;">–¢–µ–∫—Å—Ç –°–ú–°:</div>
                                <div style="background: white; padding: 10px; border-radius: 5px; font-size: 14px; color: #333; border-left: 3px solid #8e44ad;">
                                    ${shortText}
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 10px;">
                                <div style="font-size: 12px; color: #666; margin-bottom: 5px;">–ù–æ–º–µ—Ä–∞ (${mailing.–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ_–°–ú–° || 0} —à—Ç.):</div>
                                <div style="background: white; padding: 10px; border-radius: 5px; font-family: monospace; font-size: 12px; color: #333; max-height: 100px; overflow-y: auto;">
                                    ${mailing.–ù–æ–º–µ—Ä–∞_—Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ || '–ù–µ—Ç –Ω–æ–º–µ—Ä–æ–≤'}
                                </div>
                            </div>
                        </div>
                    `;
                });
            }
            
            container.innerHTML = html;
        }
        
        // ==================== –ò–°–¢–û–†–ò–Ø ====================
        function loadTransactions() {
            const transactions = [
                { type: 'deposit', amount: 25, currency: 'USDT', date: '2024-01-20 14:30' },
                { type: 'payment', amount: 10, currency: 'USDT', date: '2024-01-19 11:15' },
                { type: 'deposit', amount: 50, currency: 'TON', date: '2024-01-18 09:45' },
                { type: 'payment', amount: 8.15, currency: 'TON', date: '2024-01-17 16:20' },
                { type: 'deposit', amount: 100, currency: 'USDT', date: '2024-01-16 13:10' }
            ];
            
            let html = '';
            
            transactions.forEach(transaction => {
                const isDeposit = transaction.type === 'deposit';
                const icon = isDeposit ? 'fa-arrow-down' : 'fa-arrow-up';
                const colorClass = isDeposit ? 'deposit' : 'payment';
                const sign = isDeposit ? '+' : '-';
                
                html += `
                    <div class="history-item">
                        <div class="history-type">
                            <div class="history-icon ${colorClass}">
                                <i class="fas ${icon}"></i>
                            </div>
                            <div class="history-details">
                                <h4>${isDeposit ? '–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ' : '–û–ø–ª–∞—Ç–∞ —Ä–∞—Å—Å—ã–ª–∫–∏'}</h4>
                                <p>${transaction.date}</p>
                            </div>
                        </div>
                        <div class="history-amount">
                            <div class="amount" style="color: ${isDeposit ? '#00c851' : '#ff4444'}">
                                ${sign}${transaction.amount}
                            </div>
                            <div class="currency">${transaction.currency}</div>
                        </div>
                    </div>
                `;
            });
            
            elements.transactionsList.innerHTML = html || '<div class="loading"><p>–ù–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</p></div>';
        }
    </script>
</body>
</html>
